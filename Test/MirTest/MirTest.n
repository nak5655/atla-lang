using Nemerle;
using Nemerle.Collections;
using Nemerle.Text;
using Nemerle.Utility;

using System;
using System.Collections.Generic;
using System.Linq;

using NUnit.Framework;

using Atla.Lang.Mir;

namespace Test.MirTest
{
    [TestFixture]
    class MirTest
    {
        [Test]
        public MirEasyTest(): void {
            def asm = Atla.Lang.Mir.Assembly("Test");
            
            def code = Misc.readCase("hello.atla");
            def mir = Atla.Lang.Misc.compileToMir(asm, "main", code);
            
            Assert.AreEqual(1, mir.methods.Count());
            Assert.AreEqual(1, mir.methods.First().body.Length);
            Assert.IsInstanceOf(typeof(Atla.Lang.Mir.Ins.Call), mir.methods.First().body.First()); // it is Call, not CallAssign. Because the return value is void.
        }
    }
}
