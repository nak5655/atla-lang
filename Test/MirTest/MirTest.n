using Nemerle;
using Nemerle.Collections;
using Nemerle.Text;
using Nemerle.Utility;

using System;
using System.Collections.Generic;
using System.Linq;
using NUnit.Framework;
using Atla.Lang.Mir;

namespace Test.MirTest
{
    [TestFixture]
    class MirTest
    {
        [Test]
        public TypeEqualityTest(): void {
            def a = Type.Fn([], Type.Void());
            def b = Type.Fn([], Type.Void());
            Assert.AreEqual(a, b);
            
            def c = Type.Fn([Type.String()], Type.Void());
            def d = Type.Fn([Type.String()], Type.Void());
            Assert.AreEqual(c, d);
        }
        
        [Test]
        public IdEqualityTest(): void {
            def a = Id("aaa", Type.String());
            def b = Id("aaa", Type.String());
            Assert.AreEqual(a, b);
            
            def c = Id("aaa", Type.Fn([Type.String()], Type.Void()));
            def d = Id("aaa", Type.Fn([Type.String()], Type.Void()));
            Assert.AreEqual(c, d);
        }
        
        [Test]
        public IdHashTest(): void {
            def table: Hashtable[Atla.Lang.Mir.Id, int] = Hashtable();
            
            def a = Id("aaa", Type.String());
            def b = Id("aaa", Type.String());
            table.Add(a, 0);
            Assert.IsTrue(table.ContainsKey(b));
           
            def c = Id("aaa", Type.Fn([Type.String()], Type.Void()));
            def d = Id("aaa", Type.Fn([Type.String()], Type.Void()));
            table.Add(c, 0);
            Assert.IsTrue(table.ContainsKey(d));
        }
    }
}
